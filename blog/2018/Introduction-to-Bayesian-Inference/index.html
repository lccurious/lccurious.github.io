<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> Introduction to Bayesian Inference | Curiousity Hub </title> <meta name="author" content="Zenan Huang"> <meta name="description" content="A simple, whitespace theme for academics. Based on [*folio](https://github.com/bogoli/-folio) design. "> <meta name="keywords" content="causal-learning, causal-discovery, transfer-learning, LLMs, academic-website, portfolio-website"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="/assets/img/favicon-32x32-next-my.png?b29ea1d332f6bc3c021e15d78d266303"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://lccurious.github.io/blog/2018/Introduction-to-Bayesian-Inference/"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script src="/assets/js/theme.js?0afe9f0ae161375728f7bcc5eb5b4ab4"></script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"> Curiousity Hub </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about </a> </li> <li class="nav-item "> <a class="nav-link" href="/blog/">blog </a> </li> <li class="nav-item "> <a class="nav-link" href="/publications/">publications </a> </li> <li class="nav-item "> <a class="nav-link" href="/projects/">projects </a> </li> <li class="nav-item dropdown "> <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">submenus </a> <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdown"> <a class="dropdown-item " href="/cv/">cv</a> </div> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="fa-solid fa-moon"></i> <i class="fa-solid fa-sun"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5" role="main"> <div class="post"> <header class="post-header"> <h1 class="post-title">Introduction to Bayesian Inference</h1> <p class="post-meta"> April 11, 2018 </p> <p class="post-tags"> <a href="/blog/2018"> <i class="fa-solid fa-calendar fa-sm"></i> 2018 </a>   ·   <a href="/blog/tag/%E8%B4%9D%E5%8F%B6%E6%96%AF%E6%8E%A8%E6%96%AD"> <i class="fa-solid fa-hashtag fa-sm"></i> 贝叶斯推断</a>   <a href="/blog/tag/%E8%B4%9D%E5%8F%B6%E6%96%AF"> <i class="fa-solid fa-hashtag fa-sm"></i> 贝叶斯</a>   <a href="/blog/tag/bayesian-inference"> <i class="fa-solid fa-hashtag fa-sm"></i> Bayesian Inference</a>     ·   <a href="/blog/category/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0"> <i class="fa-solid fa-tag fa-sm"></i> 机器学习</a>   </p> </header> <article class="post-content"> <div id="markdown-content"> <p>贝叶斯推断是机器学习中常用的一种算法，在很多种情况下可以和其他数据处理技术搭配在一起。它可以处理很多种随机变量，像是参数回归、人口统计、商业KPI或者是演讲中的文字片段等。通常而言，贝叶斯推断是根据已有的数据频率分布对未知的目标进行推断，但是人们通常会用另一种方式来表述概率，像是先验和后验概率。</p> <h2 id="概念">概念</h2> <p>最基本的贝叶斯公式：</p> \[P(A\mid B) = \frac{P(A)P(B\mid A)}{P(B)}\] <p>其中A是一个事件发生的概率，而B就像是一些什么数据或者证据可以支撑A的发生。把\(P(A\mid B)\)说成是在B发生的情况下A发生的概率。</p> <p>所以推广到一般情况，假设\(\{A_i\}\)是事件集合里的一部分，对于任意的\(A_i\)，贝叶斯定理可以写成：</p> \[P(A_{i}\mid B) = \frac{P(B\mid A_{i})P(A_{i})}{\sum_{i}P(B\mid A_{i})P(A_{i})}\] <p>贝叶斯是描述某件事会不会出现的不确定性，这种不确定性则是通过已有的数据作为证据，这种事件我们则称为随机事件。随机事件的先验分布反映了我们在看到任何数据之前的信心<sup id="fnref:1" role="doc-noteref"><a href="#fn:1" class="footnote" rel="footnote">1</a></sup>，后验概率则是考虑得到的相关证据和给定数据之后所得到的条件概率，后验概率分布也是一个随机变量，是基于试验和调查之后得到的概率分布<sup id="fnref:2" role="doc-noteref"><a href="#fn:2" class="footnote" rel="footnote">2</a></sup>，也就是后验概率是受到数据分布和获得证据的影响的。</p> <h2 id="例子">例子</h2> <p><strong>例子描述：</strong> 假如我们要评估一个广告是不是有效的，我们可以根据点击这个广告的人数占看过这个广告的人数的比例来进行推测下一个看的人点击这个广告的概率。这个概率就是我们的一个参数，设为\(\theta\)值域为\([0, 1]\)，最传统的做法就是枚举这个参数值，然后看看哪个值和我们得到的数据最接近。</p> <p>\(\mathop{\arg\max}_{\theta}P(X\mid \theta)\)，其中的\(X\)就是我们观测到的数据。</p> <p>这样我们可以得到似然函数<sup id="fnref:3" role="doc-noteref"><a href="#fn:3" class="footnote" rel="footnote">3</a></sup>\(P(X\mid \theta)\)，并且很容易推断出这个值就是我们得到的历史数据中的点击比例，但是这是根据历史经验的，也许真实的值和这个差了很多呢，在你拿到的这部分数据之后人们就都不点开广告看了呢，这也是有可能的，所以为了估计得更准确一些我们再参考一些别的广告被点击的频率，这样能让我们得到的结论也更具有一般性。</p> <h3 id="先验概率分布">先验概率分布</h3> <p>在我们正式开始计算之前，我们认为这个\(\theta\)值更有可能会偏向某一个值或范围，而这种估计通常是来自下面几种：</p> <ul> <li>Informative; empirical: We have some data from related experiments and choose to leverage that data to inform our prior beliefs. Our prior beliefs will impact our final assessment.</li> <li>Informative; non-empirical: We have some inherent reason to prefer certain values over others. For instance, if we want to regularize a regression to prevent overfitting, we might set the prior distribution of our coefficients to have decreasing probability as we move away from 0. Our prior beliefs will impact our final assessment.</li> <li>Informative; domain-knowledge: Though we do not have supporting data, we know as domain experts that certain facts are more true than others. Our prior beliefs will impact our final assessment.</li> <li>Non-informative: Our prior beliefs will have little to no effect on our final assessment. We want the data to speak for itself.</li> </ul> <p>为了对\(\theta\)进行估计，我们假定这个值是符合beta分布的（这种假设就是一种先验信息，以点击率作为估计目标，还是和beta分布比较吻合的），通常我们知道正态分布、二项分布、均匀分布等但是这个beta分布讲的比较少了。简单的说就是当你不知道一个东西的具体概率是多少时，它可以给出所有概率出现的可能性大小。beta分布由两个参数决定\((\alpha, \beta)\)：</p> \[f(x;\alpha ,\beta) = \frac{x^{\alpha -1} (1-x)^{\beta-1}}{\int_{0}^1 \mu^{\alpha-1} (1-\mu)^{\beta-1} d \mu}\] <p>我们通过历史的点击数据来对这个分布进行拟合从而得到对应的\(\alpha\)、\(\beta\)的估计值。</p> <p>所以再回到我们的贝叶斯公式来推算所需的\(\theta\)：</p> \[P(\theta\mid X)=\frac{P(\theta)P(X\mid \theta)}{P(X)}\] <p>其中\(P(X)\)是一个固定值，这个值不是由\(\theta\)决定的，我们可以把后验概率表示成：</p> \[Posterior=\frac{Prior \cdot Evidence}{Constant}\] <h3 id="后验概率推断">后验概率推断</h3> <p>根据定义，后验概率的计算形式为：</p> \[P(\theta\mid X)=\frac{P(\theta)P(X\mid \theta)}{P(X)}\] <p>其中的分母\(P(X)\)是在所有合法的\(\theta\)下观察到数据的概率，为了找到全部合法的概率总值，写成数学形式就是：</p> \[\int P(\theta)P(X\mid \theta)d\theta\] <p>但是，实际问题上并不能真的通过这种公式来求得概率和，也就是说，这个公式是没有解析解的<sup id="fnref:4" role="doc-noteref"><a href="#fn:4" class="footnote" rel="footnote">4</a></sup>。所以为了求得这个值我们要换一种方式，用马尔科夫链蒙特卡罗过程（Markov Chain Monte Carlo，MCMC）对这个值进行逼近，这种方法是通过模仿那种未知分布的数据生成大量样例。先从一个具体的值开始，然后“提出”另一个值，同时也会拒绝一些不太靠谱的生成值，然后采用新生成的值，再估计得出下一步的模拟生成样例。</p> <h2 id="贝氏陷阱">贝氏陷阱</h2> <p>在很多时候，我们在已有的经验上通过观测进一步地修正和使答案更加精确，终于是我们更加了解这个事物。如果说，你以为你通过先验证据做出了大致正确的估计，可是也许这种估计就是错的，然后随着观测一步一步走向更深的谬误中去。就像马克吐温说的：“让我们陷入困境的不是无知，而是信以为真的谬误“。</p> <p>所以，你应该给各种事情都留一些概率，这样可以避免盲目地消去可能性，而正态分布，它即可以把我们的猜测集中在某个范围内，无限远处的概率虽然小，却也不为零，所以是很好的先验模型，对于任何分布，至少不会丢失某些信息。</p> <hr> <div class="footnotes" role="doc-endnotes"> <ol> <li id="fn:1" role="doc-endnote"> <p><a href="https://en.wikipedia.org/wiki/Prior_probability" rel="external nofollow noopener" target="_blank">https://en.wikipedia.org/wiki/Prior_probability</a> <a href="#fnref:1" class="reversefootnote" role="doc-backlink">↩</a></p> </li> <li id="fn:2" role="doc-endnote"> <p><a href="https://en.wikipedia.org/wiki/Posterior_probability" rel="external nofollow noopener" target="_blank">https://en.wikipedia.org/wiki/Posterior_probability</a> <a href="#fnref:2" class="reversefootnote" role="doc-backlink">↩</a></p> </li> <li id="fn:3" role="doc-endnote"> <p>似然性是用于在已知某些观测所得到的结果时，对有关食物的性质进行估计，就像是条件概率的逆反，从我们根据什么条件得出某些事件发生概率到根据某些事件的频率推断出背后的证据来。参见： <a href="https://en.wikipedia.org/wiki/Likelihood_function" rel="external nofollow noopener" target="_blank">https://en.wikipedia.org/wiki/Likelihood_function</a> <a href="#fnref:3" class="reversefootnote" role="doc-backlink">↩</a></p> </li> <li id="fn:4" role="doc-endnote"> <p>就是一些严格的公式,给出任意的自变量就可以求出其因变量,也就是问题的解。他人可以利用这些公式计算各自的问题。所谓的解析解是一种包含：分式、三角函数、指数、对数甚至无限级数等基本函数的解的形式。用来求得解析解的方法称为解析法〈analytic techniques、analytic methods〉，解析法即是常见的微积分技巧，例如分离变量法等。解析解为一封闭形式〈closed-form〉的函数，因此对任一独立变量，我们皆可将其带入解析函数求得正确的相依变量。因此，解析解也被称为闭式解（closed-form solution）。 <a href="#fnref:4" class="reversefootnote" role="doc-backlink">↩</a></p> </li> </ol> </div> </div> </article> <br> <hr> <br> <ul class="list-disc pl-8"></ul> <h2 class="text-3xl font-semibold mb-4 mt-12">Enjoy Reading This Article?</h2> <p class="mb-2">Here are some more articles you might like to read next:</p> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2021/distill/">a distill-style blog post</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2018/Monte-Carlo-Tree/">蒙特卡洛搜索树</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2015/code/">a post with code</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2019/Simple-Socket-Server/">简单的 Socket 服务</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2019/Online-Optimization/">Online Optimization</a> </li> <div id="giscus_thread" style="max-width: 800px; margin: 0 auto;"> <script>let giscusTheme=localStorage.getItem("theme"),giscusAttributes={src:"https://giscus.app/client.js","data-repo":"lccurious/lccurious.github.io","data-repo-id":"","data-category":"Comments","data-category-id":"","data-mapping":"title","data-strict":"1","data-reactions-enabled":"1","data-emit-metadata":"0","data-input-position":"bottom","data-theme":giscusTheme,"data-lang":"en",crossorigin:"anonymous",async:""},giscusScript=document.createElement("script");Object.entries(giscusAttributes).forEach(([t,e])=>giscusScript.setAttribute(t,e)),document.getElementById("giscus_thread").appendChild(giscusScript);</script> <noscript>Please enable JavaScript to view the <a href="http://giscus.app/?ref_noscript" rel="external nofollow noopener" target="_blank">comments powered by giscus.</a> </noscript> </div> </div> </div> <footer class="fixed-bottom" role="contentinfo"> <div class="container mt-0"> © Copyright 2024 Zenan Huang. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@5.0.0/imagesloaded.pkgd.min.js" integrity="sha256-htrLFfZJ6v5udOG+3kNLINIKh2gvoKqwEhHYfTTMICc=" crossorigin="anonymous"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script src="/assets/js/no_defer.js?2930004b8d7fcd0a8e00fdcfc8fc9f24"></script> <script defer src="/assets/js/common.js?da39b660470d1ba6e6b8bf5f37070b6e"></script> <script defer src="/assets/js/copy_code.js?12775fdf7f95e901d7119054556e495f" type="text/javascript"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> </body> </html>